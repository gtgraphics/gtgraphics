- content_for :stylesheets do
  = stylesheet_link_tag 'application', media: 'all', data: { turbolinks_track: true }

- content_for :javascripts do
  = javascript_include_tag 'application', data: { turbolinks_track: true }

- content_for :head do
  %meta{name: 'description', content: @page.meta_description || ''}
  %meta{name: 'keywords', content: @page.meta_keywords || ''}
  %meta{name: 'robots', content: @page.indexable? ? 'index,follow' : 'noindex,follow'}

  - # Meta Elements for OpenGraph/Social Media integration
  - if content_for? :social_meta_tags
    = yield :social_meta_tags
  - else
    %meta{property: 'og:title', content: @page.title}
    %meta{property: 'og:description', content: @page.meta_description || ''}
  %meta{property: 'og:url', content: page_url(@page)}

  - # References to other translations
  %link{rel: 'canonical', href: page_url(@page)}  
  - @page.translated_locales.reject { |locale| locale == I18n.locale }.each do |translated_locale|
    %link{rel: 'alternate', hreflang: translated_locale, href: page_url(@page, locale: translated_locale)}

- content_for :content do
  = facebook_sdk_anchor

  %a{name: 'top'}

  - if background_image
    #background{class: page.root? ? 'homepage' : 'subpage'}
      = image_tag background_url, alt: background_image.title

  .container

    #content_wrapper.row
      .col-sm-12

        = link_to :root, id: 'brand' do
          = image_tag 'logo.png', id: 'logo', alt: 'GT Graphics'
          .sr-only GT Graphics

        #page_wrapper
          %nav.navbar.navbar-top{role: 'navigation'}
            .navbar-header
              - unless page.root?
                %button.navbar-toggle{type: 'button', data: { toggle: 'collapse', target: '.navbar-collapse' }}
                  = prepend_icon :bars, translate('helpers.links.menu'), fixed_width: true, caption_html: { class: 'sr-only' }

            .navbar-collapse{class: page.root? ? nil : 'collapse'}
              %ul.nav.navbar-nav
                // = active_link_to icon(:home, size: :lg), :root, wrap_tag: :li, active: :exclusive
                - menu_items.each do |page|
                  = active_link_to page.title, page, wrap_tag: :li, active: @page.self_and_ancestors.include?(page)
              %ul.nav.navbar-nav.navbar-right
                - available_locales.sort_by { |locale| translate(locale, scope: :languages, locale: locale) }.each do |locale|
                  = active_link_to page_path(@page, locale: locale), wrap_tag: :li, hreflang: locale, lang: locale, active: locale == I18n.locale, title: translate(locale, scope: :languages, locale: locale) do
                    = prepend_flag_icon locale, translate(locale, scope: :languages, locale: locale), caption_html:{ class: 'sr-only' }

          - unless @page.homepage?
            #page_content_wrapper
              #page_content
                = render_flashes
                = render 'breadcrumbs'

                - if content_for? :page_content
                  = yield :page_content
                - else
                  = yield

  /= render 'footer'

  #back_to_top.visible-md.visible-lg
    = link_to '#top' do
      = prepend_icon :angle, translate('helpers.links.back_to_top'), fixed_width: true, direction: :up, size: 3, caption_html: { class: 'sr-only' }


= render template: 'layouts/application'